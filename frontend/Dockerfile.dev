FROM node:20-alpine

WORKDIR /app

# Install dependencies
COPY frontend/package.json /app/package.json
COPY frontend/yarn.lock /app/yarn.lock 2>/dev/null || true

RUN yarn install

# Copy application files
COPY frontend/ /app/

# Create non-root user
RUN adduser -D -u 1000 appuser && \
    chown -R appuser:appuser /app

USER appuser

EXPOSE 3000

# Start development server with hot-reloading
CMD ["yarn", "start"]
